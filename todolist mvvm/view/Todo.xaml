<Page
    x:Class="todolist_mvvm.view.Todo"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:vm="clr-namespace:todolist_mvvm.viewmodel"
    Title="Todo">
    <Grid Background="{StaticResource PageBackgroundBrush}">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto" />
            <RowDefinition Height="*" />
        </Grid.RowDefinitions>

        <DockPanel
            Grid.Row="0"
            Height="60"
            Margin="10"
            Background="{StaticResource AccentBrush}">
            <TextBlock
                Margin="10,10,10,10"
                VerticalAlignment="Center"
                FontSize="24"
                FontWeight="Bold"
                Foreground="White"
                Text="Task Manager" />
            <TextBox
                Name="searchbox"
                Width="400"
                Height="40"
                VerticalAlignment="Top"
                HorizontalContentAlignment="Left"
                Style="{StaticResource CustomTextBox}"
                Text="{Binding SearchQuery, UpdateSourceTrigger=PropertyChanged}">
                <TextBox.InputBindings>
                    <KeyBinding
                        Key="Enter"
                        Command="{Binding SearchCommand}"
                        CommandParameter="{Binding SearchQuery}" />
                </TextBox.InputBindings>
            </TextBox>
            <Button
                Width="90"
                Height="40"
                Margin="10,10,10,10"
                Padding="10,10,10,10"
                HorizontalAlignment="Right"
                Command="{Binding OpenHistoryPage}"
                CommandParameter="{Binding RelativeSource={RelativeSource AncestorType=Page}}"
                Content=" History "
                DockPanel.Dock="Right"
                Style="{StaticResource Rounded3DButtonStyle}" />
            
            <Button
                Width="90"
                Height="40"
                Margin="10,10,10,10"
                Padding="10,10,10,10"
                HorizontalAlignment="Right"
                Command="{Binding AddCommand}"
                CommandParameter="{Binding RelativeSource={RelativeSource AncestorType=Page}}"
                Content=" Add Task "
                DockPanel.Dock="Right"
                Style="{StaticResource Rounded3DButtonStyle}" />
        </DockPanel>

        <Grid Grid.Row="1" Margin="20">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*" />
                <ColumnDefinition Width="*" />
            </Grid.ColumnDefinitions>
            <Grid.RowDefinitions>
                <RowDefinition Height="*" />
                <RowDefinition Height="*" />
            </Grid.RowDefinitions>

            <GroupBox
                Grid.Row="0"
                Grid.Column="0"
                Background="{StaticResource LowPriorityBrush}"
                Header="Low Priority"
                Style="{StaticResource PriorityGroupBoxStyle}">

                <ListBox
                    ItemContainerStyle="{StaticResource TaskListBoxItemStyle}"
                    ItemsSource="{Binding LowPriorityTasks}"
                    MouseDoubleClick="ListBox_MouseDoubleClick"
                    SelectedItem="{Binding SelectedTask, Mode=TwoWay}"
                    Style="{StaticResource TaskListBoxStyle}">
                    <ListBox.ItemTemplate>
                        <StaticResource ResourceKey="TaskTemplate" />
                    </ListBox.ItemTemplate>
                </ListBox>

            </GroupBox>

            <GroupBox
                Grid.Row="0"
                Grid.Column="1"
                Background="{StaticResource MediumPriorityBrush}"
                Header="Medium Priority"
                Style="{StaticResource PriorityGroupBoxStyle}">
                <ListBox
                    ItemContainerStyle="{StaticResource TaskListBoxItemStyle}"
                    ItemsSource="{Binding MediumPriorityTasks}"
                    MouseDoubleClick="ListBox_MouseDoubleClick"
                    SelectedItem="{Binding SelectedTask, Mode=TwoWay}"
                    Style="{StaticResource TaskListBoxStyle}">
                    <ListBox.ItemTemplate>
                        <StaticResource ResourceKey="TaskTemplate" />
                    </ListBox.ItemTemplate>
                </ListBox>

            </GroupBox>


            <GroupBox
                Grid.Row="1"
                Grid.Column="0"
                Background="{StaticResource HighPriorityBrush}"
                Header="High Priority"
                Style="{StaticResource PriorityGroupBoxStyle}">
                <ListBox
                    ItemContainerStyle="{StaticResource TaskListBoxItemStyle}"
                    ItemsSource="{Binding HighPriorityTasks}"
                    MouseDoubleClick="ListBox_MouseDoubleClick"
                    SelectedItem="{Binding SelectedTask, Mode=TwoWay}"
                    Style="{StaticResource TaskListBoxStyle}">
                    <ListBox.ItemTemplate>
                        <StaticResource ResourceKey="TaskTemplate" />
                    </ListBox.ItemTemplate>
                </ListBox>
            </GroupBox>
            <GroupBox
                Grid.Row="1"
                Grid.Column="1"
                Background="{StaticResource CriticalPriorityBrush}"
                Header="Critical Priority"
                Style="{StaticResource PriorityGroupBoxStyle}">
                <ListBox
                    ItemContainerStyle="{StaticResource TaskListBoxItemStyle}"
                    ItemsSource="{Binding CriticalPriorityTasks}"
                    MouseDoubleClick="ListBox_MouseDoubleClick"
                    SelectedItem="{Binding SelectedTask, Mode=TwoWay}"
                    Style="{StaticResource TaskListBoxStyle}">
                    <ListBox.ItemTemplate>
                        <StaticResource ResourceKey="TaskTemplate" />
                    </ListBox.ItemTemplate>
                </ListBox>
            </GroupBox>
        </Grid>
    </Grid>
</Page>
